<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>mvdtool WebAssembly Demo</title>
</head>
<body>
    <h1>mvdtool WebAssembly Demo</h1>
    <input type="file" id="fileInput">
    <button onclick="runMvdtool()">Run mvdtool</button>

    <script>
        var Module = {
            print: function(text) { console.log('PERSE', text); },
            printErr: function(text) { console.error('JUTTU', text); },
            onRuntimeInitialized: function() {
                // We can now run functions in the WebAssembly module
                console.log('WASM Loaded');
            }
        };

        function runMvdtool() {
            var fileInput = document.getElementById('fileInput');
            var file = fileInput.files[0];

            if (!file) {
                alert('Please select a file first.');
                return;
            }

            var reader = new FileReader();
            reader.onload = function(event) {
                // Write the file content to the virtual file system
                var data = new Uint8Array(event.target.result);
                Module.FS_createDataFile("/", "myfile.mvd2", data, true, true);

                // Pass arguments to the WASM module
                var args = ['mvdtool', 'strings', 'myfile.mvd2'];
                Module.callMain(args);
            };

            reader.readAsArrayBuffer(file);
        }
    </script>

    {{{ SCRIPT }}}

</body>
</html>
